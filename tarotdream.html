<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¡”ç¾…ç‰Œç¾©æŸ¥è©¢èˆ‡ç·šä¸Šå åœ</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #6c5ce7;
            --bg: #dfe6e9;
            --card-bg: #fff;
            --rev-color: #c0392b;
        }

        body { font-family: "Microsoft JhengHei", sans-serif; background: var(--bg); margin: 0; padding: 20px; color: #333; }
        
        header { text-align: center; margin-bottom: 30px; }
        h1 { color: var(--primary); margin-bottom: 5px; }
        p { color: #636e72; }

        /* --- æ–°å¢ï¼šæ¨¡å¼åˆ‡æ›æŒ‰éˆ• --- */
        .mode-selector { display: flex; justify-content: center; gap: 10px; margin-bottom: 25px; flex-wrap: wrap; }
        .mode-btn {
            padding: 10px 20px; border: none; border-radius: 25px; font-size: 16px; cursor: pointer;
            background: #fff; color: var(--primary); box-shadow: 0 2px 5px rgba(0,0,0,0.1); transition: 0.3s;
        }
        .mode-btn.active, .mode-btn:hover { background: var(--accent); color: white; }

        /* --- åŸæœ‰æ§ä»¶å€åŸŸ --- */
        .controls { max-width: 800px; margin: 0 auto 30px; text-align: center; }
        
        input, select {
            width: 100%; padding: 15px; border: 2px solid #b2bec3; border-radius: 30px; 
            font-size: 16px; outline: none; box-sizing: border-box; margin-bottom: 15px;
            transition: 0.3s; background: #fff;
        }
        input:focus, select:focus { border-color: var(--accent); box-shadow: 0 0 10px rgba(108, 92, 231, 0.2); }

        .filter-buttons { display: flex; flex-wrap: wrap; justify-content: center; gap: 8px; }
        .filter-btn {
            background: #fff; border: 1px solid #b2bec3; padding: 8px 16px; 
            border-radius: 20px; cursor: pointer; transition: 0.2s; font-weight: bold; color: #636e72;
        }
        .filter-btn:hover, .filter-btn.active { background: var(--accent); color: white; border-color: var(--accent); }

        /* --- å¡ç‰‡ç¶²æ ¼ --- */
        .grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); 
            gap: 25px; max-width: 1200px; margin: 0 auto;
        }

        .card {
            background: var(--card-bg); border-radius: 15px; overflow: hidden;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); transition: transform 0.2s;
            display: flex; flex-direction: column; position: relative;
        }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,0.15); }
        
        .img-container {
            width: 100%;
            height: 350px; 
            background: #f1f2f6;
            position: relative;
            overflow: hidden;
            display: flex; /* æ–°å¢ */
            align-items: center; /* æ–°å¢ï¼šå‚ç›´ç½®ä¸­ */
            justify-content: center; /* æ–°å¢ï¼šæ°´å¹³ç½®ä¸­ */
        }
        
        .card-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center; /* ä¿®æ”¹ï¼šç¢ºä¿åœ–ç‰‡é‡é»ç½®ä¸­ */
            transition: transform 0.5s;
        }

        /* --- æ–°å¢ï¼šé€†ä½åœ–ç‰‡æ—‹è½‰æ¨£å¼ --- */
        .card-img.rotated {
            transform: rotate(180deg);
        }

        .badge {
            position: absolute; top: 10px; right: 10px; 
            color: white; padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3); z-index: 2;
            backdrop-filter: blur(5px);
        }
        
        .major { background: rgba(142, 68, 173, 0.9); } 
        .fire { background: rgba(231, 76, 60, 0.9); }  
        .water { background: rgba(52, 152, 219, 0.9); } 
        .air { background: rgba(241, 196, 15, 0.9); color: #333 !important; } 
        .earth { background: rgba(39, 174, 96, 0.9); } 

        .content { padding: 15px; flex-grow: 1; display: flex; flex-direction: column; }
        h3 { margin: 0 0 10px; color: var(--primary); font-size: 1.2em; border-bottom: 2px solid #f0f0f0; padding-bottom: 8px; }
        
        .meaning { margin-bottom: 8px; font-size: 0.9em; line-height: 1.5; color: #2d3436; }
        .label { font-weight: bold; display: inline-block; margin-right: 5px; }
        .up { color: #27ae60; }
        .rev { color: var(--rev-color); }
        .highlight { background: #ffeaa7; padding: 0 2px; }

        /* --- æ–°å¢ï¼šå åœæ¨¡å¼å°ˆç”¨æ¨£å¼ --- */
        .position-title {
            text-align: center; font-weight: bold; color: var(--accent); margin-bottom: 10px; font-size: 1.1em;
        }
        .reading-status {
            font-size: 0.8em; margin-left: 5px;
        }
        .action-btn {
            background: var(--accent); color: white; border: none; padding: 15px 30px;
            border-radius: 30px; font-size: 18px; cursor: pointer; width: 100%; max-width: 300px;
            transition: 0.3s; display: block; margin: 20px auto;
        }
        .action-btn:hover { background: #5649c0; box-shadow: 0 5px 15px rgba(108, 92, 231, 0.3); }

        /* --- é€šç”¨å·¥å…·é¡ --- */
        .hidden { display: none !important; }
        .text-center { text-align: center; }

        @media (max-width: 600px) {
            .grid { grid-template-columns: 1fr; }
            .img-container { height: 400px; }
        }

    </style>
</head>
<body>

<header>
    <h1>ğŸ”® å¡”ç¾…ç‰Œç¾©è³‡æ–™åº«èˆ‡ç·šä¸Šå åœ</h1>
    <p>ç¶“å…¸èŠå¾·å‰ç‰¹å¡”ç¾…ç‰Œ (Rider-Waite)</p>
</header>

<div class="mode-selector">
    <button class="mode-btn active" onclick="switchMode('browse')">ğŸ“– ç€è¦½ç‰Œåº«</button>
    <button class="mode-btn" onclick="switchMode('daily')">ğŸ“… æ¯æ—¥ä¸€æŠ½ (é‹å‹¢)</button>
    <button class="mode-btn" onclick="switchMode('spread')">ğŸ§™â€â™‚ï¸ å åœç‰Œé™£ (è©³ç´°)</button>
</div>

<section id="browseSection">
    <div class="controls">
        <input type="text" id="searchInput" placeholder="è¼¸å…¥é—œéµå­— (ä¾‹å¦‚ï¼šæ„›æƒ…ã€éŒ¢ã€å¯¶åŠ...)">
        <div class="filter-buttons">
            <button class="filter-btn active" onclick="filter('all', this)">å…¨éƒ¨</button>
            <button class="filter-btn" onclick="filter('major', this)">å¤§é˜¿çˆ¾å…‹é‚£</button>
            <button class="filter-btn" onclick="filter('fire', this)">æ¬Šæ– (ç«)</button>
            <button class="filter-btn" onclick="filter('water', this)">è–æ¯ (æ°´)</button>
            <button class="filter-btn" onclick="filter('air', this)">å¯¶åŠ (é¢¨)</button>
            <button class="filter-btn" onclick="filter('earth', this)">éŒ¢å¹£ (åœŸ)</button>
        </div>
    </div>
    <div id="browseGrid" class="grid"></div>
</section>

<section id="readingSection" class="hidden">
    
    <div id="spreadControls" class="controls hidden">
        <h3 class="text-center">é¸æ“‡ç‰Œé™£</h3>
        <select id="spreadSelect">
            <option value="threeCard">æ™‚é–“ä¹‹æµ (ä¸‰å¼µç‰Œï¼šéå»/ç¾åœ¨/æœªä¾†)</option>
            <option value="fourElement">å…ƒç´ å¹³è¡¡ (å››å¼µç‰Œï¼šç«/æ°´/é¢¨/åœŸç‹€æ³)</option>
            <option value="choice">äºŒé¸ä¸€æŠ‰æ“‡ (äº”å¼µç‰Œï¼šç¾æ³/é¸æ“‡Aç™¼å±•/é¸æ“‡Açµæœ/é¸æ“‡Bç™¼å±•/é¸æ“‡Bçµæœ)</option>
        </select>
        <button class="action-btn" onclick="startSpreadReading()">é–‹å§‹ç‰Œé™£å åœ</button>
    </div>

    <div id="dailyControls" class="controls hidden">
        <button class="action-btn" onclick="drawDailyCard()">âœ¨ æŠ½å–ä»Šæ—¥æŒ‡å¼•ç‰Œ âœ¨</button>
    </div>

    <div id="readingGrid" class="grid"></div>
</section>


<script>
    const imgBaseUrl = "https://www.sacred-texts.com/tarot/pkt/img/";
    
    // å®Œæ•´ 78 å¼µç‰Œè³‡æ–™
    const cards = [
        // --- å¤§é˜¿çˆ¾å…‹é‚£ (ar00 - ar21) ---
        {c:"ar00", n:"0. æ„šè€… (The Fool)", e:"major", u:"æ–°çš„é–‹å§‹ã€å†’éšªã€å¤©çœŸã€æ½›åŠ›ã€ä¿¡ä»°ä¹‹èº", r:"é­¯è½ã€å†’éšªéåº¦ã€æ„šè ¢ã€ç¼ºä¹è¨ˆç•«"},
        {c:"ar01", n:"I. é­”è¡“å¸« (The Magician)", e:"major", u:"å‰µé€ åŠ›ã€æŠ€èƒ½ã€æ„å¿—åŠ›ã€é¡¯åŒ–ã€è³‡æºå…·å‚™", r:"æ¬ºé¨™ã€æ“ç¸±ã€æ‰è¯è¢«åŸ‹æ²’ã€è¨ˆç•«ä¸å‘¨"},
        {c:"ar02", n:"II. å¥³ç¥­å¸ (High Priestess)", e:"major", u:"ç›´è¦ºã€ç¥ç§˜ã€æ½›æ„è­˜ã€å…§åœ¨æ™ºæ…§ã€éœå¿ƒ", r:"å£“æŠ‘ç›´è¦ºã€è†šæ·ºã€éš±è—çš„æ•µäººã€æƒ…ç·’ä¸ç©©"},
        {c:"ar03", n:"III. çš‡å (The Empress)", e:"major", u:"è±ç››ã€æ¯æ€§ã€è‡ªç„¶ã€æ„Ÿå®˜äº«å—ã€å­•è‚²æ–°äº‹ç‰©", r:"ä¾è³´ã€å‰µé€ åŠ›å—é˜»ã€éåº¦ä¿è­·ã€æ®éœ"},
        {c:"ar04", n:"IV. çš‡å¸ (The Emperor)", e:"major", u:"æ¬Šå¨ã€çµæ§‹ã€æ§åˆ¶ã€çˆ¶è¦ªå½¢è±¡ã€å»ºç«‹ç§©åº", r:"æš´æ”¿ã€åƒµåŒ–ã€æ¿«ç”¨æ¬ŠåŠ›ã€ç¼ºä¹ç´€å¾‹"},
        {c:"ar05", n:"V. æ•™çš‡ (The Hierophant)", e:"major", u:"å‚³çµ±ã€ä¿¡ä»°ã€å®—æ•™ã€åœ˜é«”ã€å°‹æ±‚æŒ‡å°", r:"æŒ‘æˆ°å‚³çµ±ã€æ¨™æ–°ç«‹ç•°ã€å—é™ã€éŒ¯èª¤çš„å»ºè­°"},
        {c:"ar06", n:"VI. æˆ€äºº (The Lovers)", e:"major", u:"æ„›ã€å’Œè«§ã€é—œä¿‚ã€é‡å¤§é¸æ“‡ã€åƒ¹å€¼è§€çµåˆ", r:"ä¸å’Œè«§ã€å¤±è¡¡ã€éŒ¯èª¤é¸æ“‡ã€é—œä¿‚ç ´è£‚"},
        {c:"ar07", n:"VII. æˆ°è»Š (The Chariot)", e:"major", u:"å‹åˆ©ã€æ„å¿—åŠ›ã€è‡ªå¾‹ã€æ±ºå¿ƒã€æŒæ§å±€å‹¢", r:"å¤±æ§ã€å¤±æ•—ã€ç¼ºä¹æ–¹å‘ã€å¥½é¬¥"},
        {c:"ar08", n:"VIII. åŠ›é‡ (Strength)", e:"major", u:"å…§åœ¨åŠ›é‡ã€å‹‡æ°£ã€è€å¿ƒã€åŒæƒ…ã€ä»¥æŸ”å…‹å‰›", r:"è‡ªæˆ‘æ‡·ç–‘ã€è»Ÿå¼±ã€ææ‡¼ã€è¢«æœ¬èƒ½æ§åˆ¶"},
        {c:"ar09", n:"IX. éš±å£« (The Hermit)", e:"major", u:"å…§çœã€å­¤ç¨ã€å°‹æ±‚çœŸç†ã€æŒ‡å°ã€æ·±æ€ç†Ÿæ…®", r:"å­¤ç«‹ã€å¯‚å¯ã€é€€ç¸®ã€è¿·å¤±æ–¹å‘ã€æ‹’çµ•æºé€š"},
        {c:"ar10", n:"X. å‘½é‹ä¹‹è¼ª (Wheel of Fortune)", e:"major", u:"å¥½é‹ã€æ¥­åŠ›ã€ç”Ÿå‘½é€±æœŸã€è½‰æ©é»ã€ä¸å¯æ§çš„è®ŠåŒ–", r:"å„é‹ã€æŠµæŠ—è®ŠåŒ–ã€æƒ¡æ€§å¾ªç’°ã€å»¶é²"},
        {c:"ar11", n:"XI. æ­£ç¾© (Justice)", e:"major", u:"å…¬æ­£ã€çœŸç†ã€å› æœã€æ³•å¾‹äº‹å‹™ã€åšå‡ºæ±ºå®š", r:"ä¸å…¬ã€åè¦‹ã€ä¸èª å¯¦ã€é€ƒé¿è²¬ä»»"},
        {c:"ar12", n:"XII. åŠäºº (Hanged Man)", e:"major", u:"çŠ§ç‰²ã€æ–°è¦–è§’ã€æš«åœã€ç­‰å¾…ã€æ”¾ä¸‹æ§åˆ¶", r:"ç„¡è¬‚çŠ§ç‰²ã€åœæ»¯ã€æ‹–å»¶ã€å—å®³è€…å¿ƒæ…‹"},
        {c:"ar13", n:"XIII. æ­»ç¥ (Death)", e:"major", u:"çµæŸã€è½‰è®Šã€é‡ç”Ÿã€æ–·æ¨é›¢ã€ä¸å¯é¿å…çš„æ”¹è®Š", r:"æŠ—æ‹’æ”¹è®Šã€åœæ»¯ã€ç„¡æ³•é‡‹æ‡·ã€ææ‡¼çµæŸ"},
        {c:"ar14", n:"XIV. ç¯€åˆ¶ (Temperance)", e:"major", u:"å¹³è¡¡ã€é©åº¦ã€è€å¿ƒã€å’Œè«§ã€æ•´åˆå°ç«‹é¢", r:"å¤±è¡¡ã€éåº¦ã€ç¼ºä¹è€å¿ƒã€è¡çª"},
        {c:"ar15", n:"XV. æƒ¡é­” (The Devil)", e:"major", u:"æŸç¸›ã€æˆç™®ã€ç‰©è³ªä¸»ç¾©ã€æ€§æ…¾ã€æ²ˆè¿·", r:"æ‰“ç ´æŸç¸›ã€é‡ç²è‡ªç”±ã€è¦ºé†’ã€é¢å°é™°å½±"},
        {c:"ar16", n:"XVI. é«˜å¡” (The Tower)", e:"major", u:"çªè®Šã€ç½é›£ã€å•Ÿç¤ºã€æ··äº‚ã€èˆŠæœ‰çµæ§‹å´©å¡Œ", r:"é¿å…ç½é›£ã€å»¶é²æ”¹è®Šã€é‡å»ºã€å…§åœ¨å‹•ç›ª"},
        {c:"ar17", n:"XVII. æ˜Ÿæ˜Ÿ (The Star)", e:"major", u:"å¸Œæœ›ã€éˆæ„Ÿã€å¹³éœã€ç™‚ç™’ã€æ–°çš„æ–¹å‘", r:"çµ•æœ›ã€ç¼ºä¹ä¿¡å¿ƒã€éŒ¯å¤±æ©Ÿæœƒã€æ„Ÿåˆ°å¤±è½"},
        {c:"ar18", n:"XVIII. æœˆäº® (The Moon)", e:"major", u:"å¹»è¦ºã€ææ‡¼ã€æ½›æ„è­˜ã€ä¸å®‰ã€çœ‹ä¸æ¸…çœŸç›¸", r:"æ··äº‚æ¾„æ¸…ã€é‡‹æ”¾ææ‡¼ã€æ­éœ²ç§˜å¯†ã€ç›´è¦ºæ¢å¾©"},
        {c:"ar19", n:"XIX. å¤ªé™½ (The Sun)", e:"major", u:"å¿«æ¨‚ã€æˆåŠŸã€æ´»åŠ›ã€æº«æš–ã€çœŸç›¸å¤§ç™½", r:"æš«æ™‚æŒ«æŠ˜ã€éåº¦æ¨‚è§€ã€è™›æ¦®ã€å¤±å»æ´»åŠ›"},
        {c:"ar20", n:"XX. å¯©åˆ¤ (Judgement)", e:"major", u:"é‡ç”Ÿã€å¬å–šã€è¦ºé†’ã€å› æœã€åšå‡ºé‡å¤§æ±ºå®š", r:"è‡ªæˆ‘æ‡·ç–‘ã€æ‹’çµ•å¬å–šã€å¾Œæ‚”ã€ä¸é¡˜é¢å°éå»"},
        {c:"ar21", n:"XXI. ä¸–ç•Œ (The World)", e:"major", u:"å®Œæˆã€æ•´åˆã€æˆå°±ã€åœ“æ»¿ã€ä¸€å€‹é€±æœŸçš„çµæŸ", r:"æœªå®Œæˆã€ç¼ºä¹æ”¶å°¾ã€å»¶é²ã€æ„Ÿåˆ°å—é™"},

        // --- æ¬Šæ– (wa) ---
        {c:"waac", n:"æ¬Šæ–ç‹ç‰Œ (Ace of Wands)", e:"fire", u:"éˆæ„Ÿçˆ†ç™¼ã€æ–°æ©Ÿæœƒã€æˆé•·ã€ç†±æƒ…ã€è¡Œå‹•çš„é–‹ç«¯", r:"å»¶é²ã€ç¼ºä¹å‹•åŠ›ã€éŒ¯å¤±æ©Ÿæœƒã€è¨ˆç•«å—é˜»"},
        {c:"wa02", n:"æ¬Šæ–äºŒ (Two of Wands)", e:"fire", u:"è¨ˆç•«æœªä¾†ã€å±•æœ›ã€æ±ºå®šã€ç™¼ç¾ã€æŒæ¡æ¬ŠåŠ›", r:"ææ‡¼æœªçŸ¥ã€ç¼ºä¹è¨ˆç•«ã€çŒ¶è±«ä¸æ±ºã€å›ºæ­¥è‡ªå°"},
        {c:"wa03", n:"æ¬Šæ–ä¸‰ (Three of Wands)", e:"fire", u:"æ“´å¼µã€é è¦‹ã€æµ·å¤–æ©Ÿæœƒã€é€²æ­¥ã€ç­‰å¾…æˆæœ", r:"éšœç¤™ã€å»¶èª¤ã€æŒ«æŠ˜ã€é€€ç¸®ã€è¦–é‡ç‹¹éš˜"},
        {c:"wa04", n:"æ¬Šæ–å›› (Four of Wands)", e:"fire", u:"æ…¶ç¥ã€å’Œè«§ã€æ­¸å±¬æ„Ÿã€ç©©å®šã€é‡Œç¨‹ç¢‘", r:"å®¶åº­è¡çªã€éæ¸¡æœŸã€ä¸ç©©å®šã€å–æ¶ˆæ…¶ç¥"},
        {c:"wa05", n:"æ¬Šæ–äº” (Five of Wands)", e:"fire", u:"è¡çªã€ç«¶çˆ­ã€åˆ†æ­§ã€æ··äº‚ã€è…¦åŠ›æ¿€ç›ª", r:"é¿å…è¡çªã€é”æˆå…±è­˜ã€æƒ¡æ€§ç«¶çˆ­ã€å…§åœ¨çŸ›ç›¾"},
        {c:"wa06", n:"æ¬Šæ–å…­ (Six of Wands)", e:"fire", u:"å‹åˆ©ã€èªå¯ã€æ¦®è­½ã€è‡ªä¿¡ã€å‡±æ—‹è€Œæ­¸", r:"å¤±æ•—ã€åè²å—æã€é©•å‚²è‡ªå¤§ã€ä¸å—è³è­˜"},
        {c:"wa07", n:"æ¬Šæ–ä¸ƒ (Seven of Wands)", e:"fire", u:"æŒ‘æˆ°ã€å …æŒç«‹å ´ã€é˜²ç¦¦ã€æ¯…åŠ›ã€é¢å°ç«¶çˆ­", r:"æ”¾æ£„ã€è¢«å£“å€’ã€ç¼ºä¹è‡ªä¿¡ã€ç«‹å ´å‹•æ–"},
        {c:"wa08", n:"æ¬Šæ–å…« (Eight of Wands)", e:"fire", u:"è¿…é€Ÿè¡Œå‹•ã€æ¶ˆæ¯å‚³éã€æ—…è¡Œã€é€²å±•å¿«é€Ÿ", r:"å»¶é²ã€æŒ«æŠ˜ã€æ··äº‚ã€è¡å‹•å£äº‹"},
        {c:"wa09", n:"æ¬Šæ–ä¹ (Nine of Wands)", e:"fire", u:"éŸŒæ€§ã€å‹‡æ°£ã€å …æŒåˆ°åº•ã€é˜²ç¦¦ç‹€æ…‹ã€æœ€å¾Œçš„è€ƒé©—", r:"æ”¾æ£„ã€ç­‹ç–²åŠ›ç›¡ã€å›ºåŸ·ã€é˜²ç¦¦éåº¦"},
        {c:"wa10", n:"æ¬Šæ–å (Ten of Wands)", e:"fire", u:"è² æ“”ã€è²¬ä»»ã€å£“åŠ›ã€åŠªåŠ›å·¥ä½œã€æ¥è¿‘æ¥µé™", r:"å´©æ½°ã€ç„¡æ³•æ‰¿å—ã€æ¨å¸è²¬ä»»ã€å­¸æœƒæ”¾æ‰‹"},
        {c:"wapa", n:"æ¬Šæ–ä¾è€… (Page of Wands)", e:"fire", u:"æ¢ç´¢ã€æ–°æ¶ˆæ¯ã€ç†±æƒ…ã€å¥½å¥‡å¿ƒã€å……æ»¿æ´»åŠ›çš„å¹´è¼•äºº", r:"å£æ¶ˆæ¯ã€ç¼ºä¹æ–¹å‘ã€æ‹–å»¶ã€ä¸‰åˆ†é˜ç†±åº¦"},
        {c:"wakn", n:"æ¬Šæ–é¨å£« (Knight of Wands)", e:"fire", u:"è¡Œå‹•ã€å†’éšªã€è¡å‹•ã€ç²¾åŠ›å……æ²›ã€è¿…é€Ÿçš„æ”¹è®Š", r:"é­¯è½ã€æ†¤æ€’ã€æ€¥èºã€å‚²æ…¢ã€è¨ˆç•«ä¸­æ–·"},
        {c:"waqu", n:"æ¬Šæ–çš‡å (Queen of Wands)", e:"fire", u:"è‡ªä¿¡ã€ç†±æƒ…ã€æ±ºå¿ƒã€ç¤¾äº¤é­…åŠ›ã€æº«æš–çš„å¥³æ€§å½¢è±¡", r:"å«‰å¦’ã€æƒ…ç·’åŒ–ã€æ§åˆ¶æ¬²ã€å ±å¾©å¿ƒ"},
        {c:"waki", n:"æ¬Šæ–åœ‹ç‹ (King of Wands)", e:"fire", u:"é ˜å°åŠ›ã€é è¦‹ã€å¤§è†½ã€ä¼æ¥­å®¶ç²¾ç¥ã€æœ‰é­…åŠ›çš„ç”·æ€§å½¢è±¡", r:"ç¨è£ã€è¡å‹•ã€ç„¡æƒ…ã€æœŸæœ›éé«˜"},

        // --- è–æ¯ (cu) ---
        {c:"cuac", n:"è–æ¯ç‹ç‰Œ (Ace of Cups)", e:"water", u:"æ–°æˆ€æƒ…ã€åŒæƒ…å¿ƒã€å‰µé€ åŠ›ã€æƒ…æ„Ÿçš„é–‹ç«¯ã€ç›´è¦º", r:"æƒ…æ„Ÿå£“æŠ‘ã€ç©ºè™›ã€å¤±æˆ€ã€å‰µæ„å—é˜»"},
        {c:"cu02", n:"è–æ¯äºŒ (Two of Cups)", e:"water", u:"ä¼´ä¾¶é—œä¿‚ã€å¸å¼•åŠ›ã€åˆä½œã€å’Œè«§çš„é€£çµ", r:"ä¸å¹³è¡¡ã€ç ´è£‚ã€èª¤è§£ã€æºé€šä¸è‰¯"},
        {c:"cu03", n:"è–æ¯ä¸‰ (Three of Cups)", e:"water", u:"æ…¶ç¥ã€å‹èª¼ã€åœ˜é«”èšæœƒã€åˆä½œæ„‰å¿«", r:"éåº¦æ”¾ç¸±ã€å…«å¦ã€å­¤ç«‹ã€åœ˜é«”ä¸åˆ"},
        {c:"cu04", n:"è–æ¯å›› (Four of Cups)", e:"water", u:"å†·æ¼ ã€æ²ˆæ€ã€éŒ¯å¤±æ©Ÿæœƒã€å­å€¦ã€ä¸æ»¿è¶³", r:"æŠ“ä½æ©Ÿæœƒã€è¦ºé†’ã€æ–°çš„ç†±æƒ…ã€èµ°å‡ºä½æ½®"},
        {c:"cu05", n:"è–æ¯äº” (Five of Cups)", e:"water", u:"å¤±è½ã€æ‚²å‚·ã€å¾Œæ‚”ã€å¤±æœ›ã€å°ˆæ³¨æ–¼å¤±å»çš„", r:"æ¥å—ç¾å¯¦ã€åŸè«’ã€èµ°å‡ºæ‚²å‚·ã€çœ‹åˆ°å¸Œæœ›"},
        {c:"cu06", n:"è–æ¯å…­ (Six of Cups)", e:"water", u:"æ‡·èˆŠã€ç«¥å¹´å›æ†¶ã€ç´”çœŸã€é‡é€¢ã€ç°¡å–®çš„å¿«æ¨‚", r:"æ²ˆæººéå»ã€æ‹’çµ•é•·å¤§ã€éºå¿˜ã€éæ–¼ç†æƒ³åŒ–"},
        {c:"cu07", n:"è–æ¯ä¸ƒ (Seven of Cups)", e:"water", u:"å¹»æƒ³ã€é¸æ“‡å›°é›£ã€ç™½æ—¥å¤¢ã€æ··äº‚ã€éœ€è¦å°ˆæ³¨", r:"çœ‹æ¸…ç¾å¯¦ã€åšå‡ºé¸æ“‡ã€æ¸…æ™°ã€æ‰“ç ´å¹»æƒ³"},
        {c:"cu08", n:"è–æ¯å…« (Eight of Cups)", e:"water", u:"é›¢é–‹ç¾ç‹€ã€å°‹æ‰¾çœŸç†ã€å¤±æœ›ã€æ—…è¡Œã€è¿½æ±‚æ›´é«˜çš„ç›®æ¨™", r:"çŒ¶è±«ä¸æ±ºã€ææ‡¼æ”¹è®Šã€å›åˆ°åŸé»ã€å®‰æ–¼ç¾ç‹€"},
        {c:"cu09", n:"è–æ¯ä¹ (Nine of Cups)", e:"water", u:"é¡˜æœ›æˆçœŸã€æ»¿è¶³ã€å¿«æ¨‚ã€äº«å—ã€æƒ…æ„Ÿè±æ”¶", r:"è²ªå©ªã€ä¸æ»¿ã€ç‚«è€€ã€æ”¾ç¸±ã€è¡¨é¢çš„å¿«æ¨‚"},
        {c:"cu10", n:"è–æ¯å (Ten of Cups)", e:"water", u:"å®¶åº­å¹¸ç¦ã€å’Œè«§ã€æƒ…æ„Ÿåœ“æ»¿ã€é•·ä¹…çš„å¿«æ¨‚", r:"å®¶åº­å¤±å’Œã€åƒ¹å€¼è§€è¡çªã€åˆ†é›¢ã€æƒ…æ„Ÿç–é›¢"},
        {c:"cupa", n:"è–æ¯ä¾è€… (Page of Cups)", e:"water", u:"æƒ…æ„Ÿè¨Šæ¯ã€ç›´è¦ºã€å‰µæ„ç™¼æƒ³ã€æ•æ„Ÿçš„å¹´è¼•äºº", r:"æƒ…ç·’ä¸ç©©ã€å£æ¶ˆæ¯ã€å¹¼ç¨šã€å‰µæ„å—é˜»"},
        {c:"cukn", n:"è–æ¯é¨å£« (Knight of Cups)", e:"water", u:"æµªæ¼«ã€æ±‚æ„›ã€é­…åŠ›ã€æƒ³åƒåŠ›ã€è¿½éš¨å…§å¿ƒ", r:"æƒ…ç·’åŒ–ã€æ¬ºé¨™ã€ä¸åˆ‡å¯¦éš›ã€é€ƒé¿ç¾å¯¦"},
        {c:"cuqu", n:"è–æ¯çš‡å (Queen of Cups)", e:"water", u:"æ…ˆæ‚²ã€é—œæ‡·ã€ç›´è¦ºå¼·ã€æƒ…æ„Ÿæ·±åº¦ã€æº«æŸ”çš„å¥³æ€§å½¢è±¡", r:"ä¾è³´ã€æƒ…ç·’å‹’ç´¢ã€å¤šæ„å–„æ„Ÿã€ç•Œç·šä¸æ¸…"},
        {c:"cuki", n:"è–æ¯åœ‹ç‹ (King of Cups)", e:"water", u:"æƒ…ç·’å¹³è¡¡ã€å¯¬å®¹ã€å¤–äº¤ã€æ™ºæ…§ã€æˆç†Ÿçš„ç”·æ€§å½¢è±¡", r:"å†·æ¼ ã€æƒ…ç·’æ“æ§ã€å–œæ€’ç„¡å¸¸ã€å£“æŠ‘æƒ…æ„Ÿ"},

        // --- å¯¶åŠ (sw) ---
        {c:"swac", n:"å¯¶åŠç‹ç‰Œ (Ace of Swords)", e:"air", u:"çªç ´ã€æ¸…æ™°ã€æ–°æƒ³æ³•ã€çœŸç†ã€ç†æ€§çš„é–‹ç«¯", r:"æ··äº‚ã€æ€ç·’ä¸æ¸…ã€æ®˜é…·ã€è¨ˆç•«å¤±æ•—"},
        {c:"sw02", n:"å¯¶åŠäºŒ (Two of Swords)", e:"air", u:"åƒµå±€ã€å›°é›£æ±ºå®šã€é€ƒé¿ã€å¦¥å”ã€è’™è”½é›™çœ¼", r:"åšå‡ºæ±ºå®šã€æ­éœ²çœŸç›¸ã€é‡‹æ”¾ã€æ‰“ç ´åƒµå±€"},
        {c:"sw03", n:"å¯¶åŠä¸‰ (Three of Swords)", e:"air", u:"å¿ƒç¢ã€æ‚²å‚·ã€ç—›è‹¦ã€åˆ†é›¢ã€èƒŒå›", r:"é‡‹æ”¾ç—›è‹¦ã€åŸè«’ã€åº·å¾©ä¸­ã€æ‹’çµ•æ¥å—"},
        {c:"sw04", n:"å¯¶åŠå›› (Four of Swords)", e:"air", u:"ä¼‘æ¯ã€æ¢å¾©ã€æ²ˆæ€ã€æš«åœã€å……é›»", r:"éå‹ã€æ¢å¾©æ´»å‹•ã€å£“åŠ›ã€è¢«è¿«ä¼‘æ¯"},
        {c:"sw05", n:"å¯¶åŠäº” (Five of Swords)", e:"air", u:"è¡çªã€å¤±æ•—ã€è‡ªç§ã€ä¸æ“‡æ‰‹æ®µçš„å‹åˆ©", r:"å’Œè§£ã€åŸè«’ã€è§£æ±ºè¡çªã€æ¥å—å¤±æ•—"},
        {c:"sw06", n:"å¯¶åŠå…­ (Six of Swords)", e:"air", u:"éæ¸¡æœŸã€é›¢é–‹ç—›è‹¦ã€ç™‚ç™’ä¹‹æ—…ã€å°‹æ±‚å¹³éœ", r:"æƒ…æ„ŸåŒ…è¢±ã€ç„¡æ³•å‰é€²ã€æ—…é€”å—é˜»ã€å›°åœ¨éå»"},
        {c:"sw07", n:"å¯¶åŠä¸ƒ (Seven of Swords)", e:"air", u:"æ¬ºé¨™ã€ç­–ç•¥ã€å·ç«Šã€é€ƒé¿è²¬ä»»ã€å­¤è»å¥®æˆ°", r:"è‡ªç™½ã€è¢«æ­ç©¿ã€è‰¯å¿ƒç™¼ç¾ã€æ”¹è®Šç­–ç•¥"},
        {c:"sw08", n:"å¯¶åŠå…« (Eight of Swords)", e:"air", u:"æŸç¸›ã€å—å®³è€…å¿ƒæ…‹ã€ç„¡åŠ›æ„Ÿã€è‡ªæˆ‘è¨­é™", r:"é‡ç²è‡ªç”±ã€æ–°è¦–è§’ã€è§£æ±ºå•é¡Œã€æ‰“ç ´é™åˆ¶"},
        {c:"sw09", n:"å¯¶åŠä¹ (Nine of Swords)", e:"air", u:"ç„¦æ…®ã€å™©å¤¢ã€ææ‡¼ã€çµ•æœ›ã€å¤±çœ ", r:"ææ‡¼é‡‹æ”¾ã€æ±‚åŠ©ã€å¥½è½‰ã€é¢å°ç¾å¯¦"},
        {c:"sw10", n:"å¯¶åŠå (Ten of Swords)", e:"air", u:"æ¯€æ»…ã€ç—›è‹¦çµæŸã€èƒŒå›ã€æœ€ä½é»", r:"å¾©ç”¦ã€å€–å­˜ã€ä¸å¯é¿å…çš„çµæŸã€æœ€å£çš„å·²éå»"},
        {c:"swpa", n:"å¯¶åŠä¾è€… (Page of Swords)", e:"air", u:"å¥½å¥‡ã€æ–°æƒ³æ³•ã€æºé€šã€è§€å¯Ÿã€æ©Ÿæ™ºçš„å¹´è¼•äºº", r:"æ•£æ¼«ã€æ¬ºé¨™ã€èªªé–’è©±ã€ååŸ·ã€è¨€èªå‚·äºº"},
        {c:"swkn", n:"å¯¶åŠé¨å£« (Knight of Swords)", e:"air", u:"é‡å¿ƒã€è¡Œå‹•è¿…é€Ÿã€ç›´æ¥ã€æœæ–·ã€æ™ºåŠ›æŒ‘æˆ°", r:"è¡å‹•ã€é­¯è½ã€è¨€èªæš´åŠ›ã€éŒ¯å¤±é‡é»"},
        {c:"swqu", n:"å¯¶åŠçš‡å (Queen of Swords)", e:"air", u:"ç¨ç«‹ã€æ¸…æ™°åˆ¤æ–·ã€ç•Œç·šåˆ†æ˜ã€ç›´æ¥ã€ç†æ€§çš„å¥³æ€§å½¢è±¡", r:"å†·é…·ã€è‹¦æ¾€ã€æ®˜å¿ã€æƒ…ç·’åŒ–ã€éæ–¼æ‰¹åˆ¤"},
        {c:"swki", n:"å¯¶åŠåœ‹ç‹ (King of Swords)", e:"air", u:"ç†æ™ºæ¬Šå¨ã€çœŸç†ã€å…¬æ­£ã€ç´€å¾‹ã€ç†æ€§çš„ç”·æ€§å½¢è±¡", r:"æ“ç¸±ã€æš´å›ã€æ®˜å¿ã€å†·è¡€ã€æ¿«ç”¨æ³•å¾‹"},

        // --- éŒ¢å¹£ (pe) ---
        {c:"peac", n:"éŒ¢å¹£ç‹ç‰Œ (Ace of Pentacles)", e:"earth", u:"æ–°æ©Ÿæœƒã€ç¹æ¦®ã€è²¡å¯Œã€ç©©å®šã€ç‰©è³ªçš„é–‹ç«¯", r:"éŒ¯å¤±æ©Ÿæœƒã€è²¡å‹™æå¤±ã€è²ªå©ªã€ç¼ºä¹è¦åŠƒ"},
        {c:"pe02", n:"éŒ¢å¹£äºŒ (Two of Pentacles)", e:"earth", u:"å¹³è¡¡ã€é©æ‡‰ã€å¤šé‡ä»»å‹™ã€è²¡å‹™ç®¡ç†ã€å½ˆæ€§", r:"å¤±è¡¡ã€æ··äº‚ã€è²¡å‹™å›°é›£ã€ä¸å ªé‡è² "},
        {c:"pe03", n:"éŒ¢å¹£ä¸‰ (Three of Pentacles)", e:"earth", u:"åœ˜éšŠåˆä½œã€æŠ€èƒ½ã€åŸ·è¡Œã€å“è³ªã€å°ˆæ¥­èªå¯", r:"ç¼ºä¹åˆä½œã€å·¥ä½œæ‡¶æ•£ã€å“è³ªä½åŠ£ã€ç„¡æ³•å”èª¿"},
        {c:"pe04", n:"éŒ¢å¹£å›› (Four of Pentacles)", e:"earth", u:"å®ˆè²¡ã€æ§åˆ¶ã€å®‰å…¨æ„Ÿã€ç©©å®šã€ä½”æœ‰æ…¾", r:"æ…·æ…¨ã€å¤±å»æ§åˆ¶ã€æ®éœã€è²¡å‹™ä¸å®‰å…¨"},
        {c:"pe05", n:"éŒ¢å¹£äº” (Five of Pentacles)", e:"earth", u:"è²§çª®ã€å­¤ç«‹ã€ä¸å®‰å…¨æ„Ÿã€æå¤±ã€å°‹æ±‚æ´åŠ©", r:"æ¢å¾©ã€æ´åŠ©åˆ°ä¾†ã€å¥½è½‰ã€é‡æ‹¾ä¿¡å¿ƒ"},
        {c:"pe06", n:"éŒ¢å¹£å…­ (Six of Pentacles)", e:"earth", u:"æ…·æ…¨ã€æ…ˆå–„ã€çµ¦äºˆèˆ‡æ¥å—ã€è²¡å‹™å¹³è¡¡", r:"å‚µå‹™ã€è‡ªç§ã€ä¸å¹³ç­‰äº¤æ˜“ã€æœ‰æ¢ä»¶çš„çµ¦äºˆ"},
        {c:"pe07", n:"éŒ¢å¹£ä¸ƒ (Seven of Pentacles)", e:"earth", u:"è€å¿ƒã€è©•ä¼°ã€é•·æœŸæŠ•è³‡ã€ç­‰å¾…æ”¶ç©«", r:"ç¼ºä¹å›å ±ã€ç„¦æ…®ã€æ”¾æ£„ã€æŠ•è³‡å¤±èª¤"},
        {c:"pe08", n:"éŒ¢å¹£å…« (Eight of Pentacles)", e:"earth", u:"å‹¤å¥®ã€æŠ€èƒ½ç²¾é€²ã€å°ˆæ³¨ç´°ç¯€ã€å·¥åŒ ç²¾ç¥", r:"å®Œç¾ä¸»ç¾©ã€ç¼ºä¹é‡å¿ƒã€å·¥ä½œéåº¦ã€ç²—è£½æ¿«é€ "},
        {c:"pe09", n:"éŒ¢å¹£ä¹ (Nine of Pentacles)", e:"earth", u:"å¯Œè¶³ã€ç¨ç«‹ã€äº«å—ç”Ÿæ´»ã€è‡ªæˆ‘ä¾è³´ã€å„ªé›…", r:"ä¾è³´ã€è²¡å‹™ä¾è³´ã€è†šæ·ºã€ç‚«å¯Œ"},
        {c:"pe10", n:"éŒ¢å¹£å (Ten of Pentacles)", e:"earth", u:"éºç”¢ã€å®¶åº­å¯Œè£•ã€é•·æœŸç©©å®šã€å‚³çµ±ã€å®¶æ—åŸºæ¥­", r:"å®¶åº­ç´›çˆ­ã€è²¡å‹™å¤±æ•—ã€å¤±å»éºç”¢ã€å‚³çµ±è² æ“”"},
        {c:"pepa", n:"éŒ¢å¹£ä¾è€… (Page of Pentacles)", e:"earth", u:"å±•ç¾ã€å­¸ç¿’æ©Ÿæœƒã€å‹¤å¥®ã€å‹™å¯¦ã€è¸å¯¦çš„å¹´è¼•äºº", r:"æ‹–å»¶ã€ç¼ºä¹é€²æ­¥ã€æ‡¶æƒ°ã€ä¸åˆ‡å¯¦éš›"},
        {c:"pekn", n:"éŒ¢å¹£é¨å£« (Knight of Pentacles)", e:"earth", u:"æ•ˆç‡ã€ä¾‹è¡Œå…¬äº‹ã€ä¿å®ˆã€è² è²¬ã€ç©©å¥å‰è¡Œ", r:"åœæ»¯ã€æ‡¶æƒ°ã€é ‘å›ºã€ç„¡èŠã€éæ–¼è¬¹æ…"},
        {c:"pequ", n:"éŒ¢å¹£çš‡å (Queen of Pentacles)", e:"earth", u:"å‹™å¯¦ã€æ»‹é¤Šã€è²¡å‹™å®‰å…¨ã€æ„›å®¶ã€æ…·æ…¨çš„å¥³æ€§å½¢è±¡", r:"å·¥ä½œç‹‚ã€å«‰å¦’ã€è‡ªæˆ‘æ‡·ç–‘ã€ç‰©è³ªè‡³ä¸Š"},
        {c:"peki", n:"éŒ¢å¹£åœ‹ç‹ (King of Pentacles)", e:"earth", u:"å¯Œè£•ã€å•†æ¥­é ­è…¦ã€ç´€å¾‹ã€æˆåŠŸã€ç©©é‡çš„ç”·æ€§å½¢è±¡", r:"è²ªå©ªã€å›ºåŸ·ã€ç‰©è³ªä¸»ç¾©ã€è…æ•—"}
    ];

    // ç‰Œé™£å®šç¾©
    const spreadDefinitions = {
        threeCard: {
            name: "æ™‚é–“ä¹‹æµç‰Œé™£",
            positions: ["éå»çš„ç¶“é©—/åŸå› ", "ç¾åœ¨çš„ç‹€æ³/æŒ‘æˆ°", "æœªä¾†çš„ç™¼å±•/çµæœ"]
        },
        fourElement: {
            name: "å››å…ƒç´ å¹³è¡¡ç‰Œé™£",
            positions: ["ç« (è¡Œå‹•åŠ›/ç†±æƒ…)", "æ°´ (æƒ…æ„Ÿ/äººéš›)", "é¢¨ (æ€è€ƒ/æºé€š)", "åœŸ (ç‰©è³ª/å·¥ä½œ)"]
        },
        choice: {
            name: "äºŒé¸ä¸€æŠ‰æ“‡ç‰Œé™£",
            positions: ["ç›®å‰çš„ç‹€æ³", "é¸æ“‡ A çš„éç¨‹", "é¸æ“‡ A çš„çµæœ", "é¸æ“‡ B çš„éç¨‹", "é¸æ“‡ B çš„çµæœ"]
        }
    };

    const browseGrid = document.getElementById('browseGrid');
    const readingGrid = document.getElementById('readingGrid');
    const input = document.getElementById('searchInput');
    const browseSection = document.getElementById('browseSection');
    const readingSection = document.getElementById('readingSection');
    const spreadControls = document.getElementById('spreadControls');
    const dailyControls = document.getElementById('dailyControls');
    let currentType = 'all';
    let currentMode = 'browse';

    // --- æ ¸å¿ƒåŠŸèƒ½ï¼šæ´—ç‰Œ (Fisher-Yates Shuffle) ---
    function shuffleDeck() {
        const deck = [...cards]; // è¤‡è£½ä¸€ä»½æ–°ç‰Œçµ„
        for (let i = deck.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [deck[i], deck[j]] = [deck[j], deck[i]];
        }
        return deck;
    }

    // --- æ¨¡å¼åˆ‡æ›é‚è¼¯ ---
    function switchMode(mode) {
        currentMode = mode;
        // æ›´æ–°æŒ‰éˆ•ç‹€æ…‹
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.classList.toggle('active', btn.textContent.includes(mode === 'browse' ? 'ç€è¦½' : mode === 'daily' ? 'æ¯æ—¥' : 'ç‰Œé™£'));
        });

        // éš±è—æ‰€æœ‰å€å¡Š
        browseSection.classList.add('hidden');
        readingSection.classList.add('hidden');
        spreadControls.classList.add('hidden');
        dailyControls.classList.add('hidden');
        readingGrid.innerHTML = ''; // æ¸…ç©ºå åœçµæœ

        // é¡¯ç¤ºå°æ‡‰å€å¡Š
        if (mode === 'browse') {
            browseSection.classList.remove('hidden');
            renderBrowse(cards); // é‡æ–°æ¸²æŸ“ç€è¦½ä»‹é¢
        } else {
            readingSection.classList.remove('hidden');
            if (mode === 'daily') {
                dailyControls.classList.remove('hidden');
                readingGrid.innerHTML = '<div class="text-center" style="grid-column:1/-1; padding:30px; color:#666;">è«‹é»æ“ŠæŒ‰éˆ•æŠ½å–ä»Šæ—¥æŒ‡å¼•ç‰Œã€‚</div>';
            } else if (mode === 'spread') {
                spreadControls.classList.remove('hidden');
                readingGrid.innerHTML = '<div class="text-center" style="grid-column:1/-1; padding:30px; color:#666;">è«‹é¸æ“‡ç‰Œé™£ä¸¦é»æ“Šé–‹å§‹æŒ‰éˆ•ã€‚</div>';
            }
        }
    }

    // --- åŠŸèƒ½ï¼šæ¯æ—¥ä¸€æŠ½ ---
    function drawDailyCard() {
        readingGrid.innerHTML = '<div class="text-center" style="grid-column:1/-1; padding:30px;">æ­£åœ¨æ´—ç‰Œä¸¦é€£çµèƒ½é‡...</div>';
        setTimeout(() => {
            const deck = shuffleDeck();
            const card = deck[0];
            // 50% æ©Ÿç‡æ±ºå®šæ­£é€†ä½ (true = æ­£ä½, false = é€†ä½)
            const isUpright = Math.random() > 0.5;
            
            readingGrid.innerHTML = '';
            renderDrawResult(card, isUpright, "ä»Šæ—¥æŒ‡å¼•");
        }, 800); // æ¨¡æ“¬æ´—ç‰Œå»¶é²
    }

    // --- åŠŸèƒ½ï¼šé–‹å§‹ç‰Œé™£å åœ ---
    function startSpreadReading() {
        const spreadKey = document.getElementById('spreadSelect').value;
        const spread = spreadDefinitions[spreadKey];
        
        readingGrid.innerHTML = '<div class="text-center" style="grid-column:1/-1; padding:30px;">æ­£åœ¨å°ˆæ³¨æ´—ç‰Œ...</div>';
        
        setTimeout(() => {
            const deck = shuffleDeck();
            readingGrid.innerHTML = ''; // æ¸…ç©ºç¶²æ ¼

            // æ ¹æ“šç‰Œé™£ä½ç½®æ•¸é‡æŠ½ç‰Œ
            spread.positions.forEach((positionTitle, index) => {
                const card = deck[index];
                const isUpright = Math.random() > 0.5;
                renderDrawResult(card, isUpright, positionTitle);
            });
        }, 1000);
    }

    // --- æ¸²æŸ“å‡½æ•¸ 1: å åœçµæœæ¸²æŸ“ (ç”¨æ–¼æ¯æ—¥ä¸€æŠ½å’Œç‰Œé™£) ---
    function renderDrawResult(cardData, isUpright, positionTitle) {
        const imgSrc = imgBaseUrl + cardData.c + ".jpg";
        let elName = getElementName(cardData.e);
        
        const statusText = isUpright ? "æ­£ä½" : "é€†ä½";
        const statusClass = isUpright ? "up" : "rev";
        const imgClass = isUpright ? "" : "rotated";
        // æ ¹æ“šæ­£é€†ä½é¸æ“‡è¦é¡¯ç¤ºçš„é‡‹ç¾©
        const meaningText = isUpright ? cardData.u : cardData.r;

        const div = document.createElement('div');
        div.className = 'card animated fadeIn';
        // åœ¨å¡ç‰‡ä¸Šæ–¹å¢åŠ ä½ç½®æ¨™é¡Œ
        div.innerHTML = `
            <div class="content" style="padding-bottom:0;">
                <div class="position-title">ã€ ${positionTitle} ã€‘</div>
            </div>
            <div class="img-container">
                <span class="badge ${cardData.e}">${elName}</span>
                <img src="${imgSrc}" alt="${cardData.n}" class="card-img ${imgClass}" loading="lazy" 
                     onerror="this.src='https://via.placeholder.com/200x350?text=Image+Error'">
            </div>
            <div class="content">
                <h3>${cardData.n} <span class="reading-status ${statusClass}">(${statusText})</span></h3>
                <div class="meaning" style="font-size:1.1em; font-weight:bold;">
                    <span class="${statusClass}">${isUpright ? 'â–²' : 'â–¼'} é‡‹ç¾©ï¼š</span>
                    ${meaningText}
                </div>
                 <div class="meaning" style="margin-top:10px; font-size:0.9em; color:#666; border-top:1px dashed #eee; padding-top:10px;">
                    (åƒè€ƒç‰Œç¾©ï¼š${isUpright ? cardData.u : cardData.r})
                </div>
            </div>
        `;
        readingGrid.appendChild(div);
    }


    // --- æ¸²æŸ“å‡½æ•¸ 2: ç€è¦½æ¨¡å¼æ¸²æŸ“ (åŸæœ‰çš„åŠŸèƒ½) ---
    function renderBrowse(data) {
        browseGrid.innerHTML = '';
        if(data.length === 0) {
            browseGrid.innerHTML = '<div style="grid-column:1/-1;text-align:center;padding:40px;color:#999;">æ‰¾ä¸åˆ°ç›¸é—œç‰Œç¾©</div>';
            return;
        }

        data.forEach(d => {
            let elName = getElementName(d.e);
            const imgSrc = imgBaseUrl + d.c + ".jpg";

            const div = document.createElement('div');
            div.className = 'card';
            div.innerHTML = `
                <div class="img-container">
                    <span class="badge ${d.e}">${elName}</span>
                    <img src="${imgSrc}" alt="${d.n}" class="card-img" loading="lazy" 
                         onerror="this.src='https://via.placeholder.com/200x350?text=Image+Error'">
                </div>
                <div class="content">
                    <h3>${hl(d.n)}</h3>
                    <div class="meaning">
                        <span class="label up">â–² æ­£ä½ï¼š</span>
                        <span>${hl(d.u)}</span>
                    </div>
                    <div class="meaning">
                        <span class="label rev">â–¼ é€†ä½ï¼š</span>
                        <span>${hl(d.r)}</span>
                    </div>
                </div>
            `;
            browseGrid.appendChild(div);
        });
    }

    // --- è¼”åŠ©å‡½æ•¸ ---
    function getElementName(e) {
        if(e === 'major') return 'å¤§ç‰Œ';
        if(e === 'fire') return 'ç«';
        if(e === 'water') return 'æ°´';
        if(e === 'air') return 'é¢¨';
        if(e === 'earth') return 'åœŸ';
        return '';
    }

    function hl(txt) {
        const v = input.value.trim();
        if(!v) return txt;
        return txt.replace(new RegExp(v, 'gi'), m => `<span class="highlight">${m}</span>`);
    }

    function filter(type, btn) {
        currentType = type;
        if(btn) {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }
        search();
    }

    function search() {
        const v = input.value.trim().toLowerCase();
        const res = cards.filter(c => {
            if(currentType !== 'all' && c.e !== currentType) return false;
            return c.n.toLowerCase().includes(v) || c.u.includes(v) || c.r.includes(v);
        });
        renderBrowse(res);
    }

    // --- åˆå§‹åŒ– ---
    input.addEventListener('input', search);
    // åˆå§‹è¼‰å…¥ç€è¦½ä»‹é¢
    renderBrowse(cards);

</script>
</body>
</html>
